---
import Button from "../components/Button.astro";
---

<!-- Accessibility settings bar -->
<div id="accessibility-bar" class="fixed w-full bg-gray-950 text-gray-50 flex justify-start gap-6 items-center h-9 p-4 z-50">
  <!-- Text Size Toggle -->
  <div class="flex items-center gap-2">
    <label for="textSizeToggle" class="cursor-pointer md:block hidden">Stor tekst</label>
    <button id="textSizeToggle" aria-pressed="false" class="toggle-switch">
      <span class="toggle-circle"></span>
    </button>
  </div>

  <!-- Dark Mode Toggle -->
  <div class="flex items-center gap-2">
    <label for="darkModeToggle" class="cursor-pointer md:block hidden">Mørk tilstand</label>
    <button id="darkModeToggle" aria-pressed="false" class="toggle-switch">
      <span class="toggle-circle"></span>
    </button>
  </div>

  <!-- Reduce Motion Toggle -->
  <div class="flex items-center gap-2">
    <label for="motionToggle" class="cursor-pointer md:block hidden">Fjern animationer</label>
    <button id="motionToggle" aria-pressed="false" class="toggle-switch">
      <span class="toggle-circle"></span>
    </button>
  </div>
</div>

<div id="header" x-data="{ showmenu: false }" class="fixed p-4 z-20 w-full bg-gray-50 shadow-drop25 pt-12">
  <div id="navbar" class="flex flex-row justify-between gap-8 max-w-7xl mx-auto md:px-0 px-4 py-3">
    <div class="">
      <a href="/">
        <img
          src="/images/logo_blaa.webp"
          alt="Logo for CP Danmark i blåt"
          class="h-11 hover:opacity-50 transition duration-300 ease-in-out logo-light"
        />
        <img
          src="/images/logo_hvid.webp"
          alt="Logo for CP Danmark i hvidt"
          class="h-11 hover:opacity-50 transition duration-300 ease-in-out logo-dark"
        />
      </a>
    </div>
    <nav id="desktopmenu" class="hidden lg:block content-center">
      <ul class="flex flex-row content-center gap-4">
        <!-- CP & os Dropdown -->
        <li class="relative" x-data="{ showDropdown1: false }" x-cloak @mouseenter="showDropdown1 = true" @mouseleave="showDropdown1 = false">
          <a href="/cp_os" class="hover:text-blue-700 py-1 flex items-center">
            CP & os
            <svg
              class="w-4 h-4 ml-2 transition-transform duration-300 transform"
              :class="{ 'rotate-180': showDropdown1 }"
              xmlns="http://www.w3.org/2000/svg"
              fill="none"
              viewBox="0 0 24 24"
              stroke-width="2"
              stroke="currentColor"
            >
              <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"></path>
            </svg>
          </a>
          <div
            x-show="showDropdown1"
            x-transition
            class="dropdown1 absolute left-0 mt-2 w-[165px] bg-gray-50 shadow-drop25 border border-gray-400 z-10"
          >
            <ul>
              <li class="py-1 px-4"><a href="/hvad_er_cp" aria-label="Gå til Hvad er CP?" class="hover:text-blue-700">Hvad er CP?</a></li>
              <li class="py-1 px-4"><a href="/cp_ung" aria-label="Gå til CP Ung" class="hover:text-blue-700">CP Ung</a></li>
              <li class="py-1 px-4"><a href="/nyheder" aria-label="Gå til Nyheder" class="hover:text-blue-700">Nyheder</a></li>
            </ul>
          </div>
        </li>
        <li class="relative" x-data="{ showDropdown2: false }" x-cloak @mouseenter="showDropdown2 = true" @mouseleave="showDropdown2 = false">
          <a href="#" class="hover:text-blue-700 py-1 flex items-center">
            Bliv klogere
            <svg
              class="w-4 h-4 ml-2 transition-transform duration-300 transform"
              :class="{ 'rotate-180': showDropdown2 }"
              xmlns="http://www.w3.org/2000/svg"
              fill="none"
              viewBox="0 0 24 24"
              stroke-width="2"
              stroke="currentColor"
            >
              <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"></path>
            </svg>
          </a>
          <div
            x-show="showDropdown2"
            x-transition
            class="dropdown2 absolute left-0 mt-2 w-[220px] bg-gray-50 shadow-drop25 border border-gray-400 z-10"
          >
            <ul>
              <li class="py-1 px-4"><a href="/raadgivning" aria-label="Gå til Gå til 'Rådgivning'" class="hover:text-blue-700">Rådgivning</a></li>
              <li class="py-1 px-4"><a href="/materialer" aria-label="Gå til Gå til 'Materialer'" class="hover:text-blue-700">Materialer</a></li>
              <li class="py-1 px-4">
                <a href="/kurser_aktiviteter" aria-label="Gå til Kurser & aktiviteter" class="hover:text-blue-700">Kurser & aktiviteter</a>
              </li>
            </ul>
          </div>
        </li>
        <li><a href="/tilmeld" aria-label="Gå til Gå til 'Tilmeld'" class="relative flex items-center hover:text-blue-700 py-1">Bliv medlem</a></li>
        <li><a href="/goode_raad" aria-label="Gå til Gå til 'Gode råd'" class="relative flex items-center hover:text-blue-700 py-1">Gode råd</a></li>
      </ul>
    </nav>
    <div class="ml-auto hidden md:block">
      <a href="/stoet" aria-label="Gå til Gå til 'Støt os'">
        <Button variant="primary" size="small">Støt os</Button>
      </a>
    </div>
    <button id="burgermenu" class="lg:hidden z-50" x-on:click="showmenu = !showmenu">
      <template x-if="showmenu">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          fill="none"
          viewBox="0 0 24 24"
          stroke-width="1.5"
          stroke="currentColor"
          class="size-9 hover:text-blue-700 transition duration-300"
        >
          <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12"></path>
        </svg>
      </template>
      <template x-if="!showmenu">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          fill="none"
          viewBox="0 0 24 24"
          stroke-width="1.5"
          stroke="currentColor"
          class="size-9 hover:text-blue-700 transition duration-300"
        >
          <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 9h16.5m-16.5 6.75h16.5"></path>
        </svg>
      </template>
    </button>
  </div>
  <nav
    id="mobilmenu"
    class="flex flex-col content-center pt-4"
    x-show="showmenu"
    x-transition
    x-cloak
    x-on:click="showmenu = false"
    x-on:click.outside="showmenu = false"
  >
    <ul class="mx-auto py-4 text-gray-950">
      <h4 class="text-center font-bold">Viden & information</h4>
      <li class="text-center py-2 border-b">
        <a href="/cp_os" aria-label="Gå til 'CP & os'" class="hover:text-blue-700 hover:underline transition duration-300 ease-in-out">CP & os</a>
      </li>
      <li class="text-center py-2 border-b">
        <a href="/hvad_er_cp" aria-label="Gå til 'Hvad er CP?'" class="hover:text-blue-700 hover:underline transition duration-300 ease-in-out"
          >Hvad er CP?</a
        >
      </li>
      <li class="text-center py-2 border-b">
        <a href="/cp_ung" aria-label="Gå til 'CP Ung'" class="hover:text-blue-700 hover:underline transition duration-300 ease-in-out">CP Ung</a>
      </li>
      <li class="text-center py-2 border-b">
        <a href="/nyheder" aria-label="Gå til 'Nyheder'" class="hover:text-blue-700 hover:underline transition duration-300 ease-in-out">Nyheder</a>
      </li>
    </ul>
    <ul class="mx-auto py-4 text-gray-950">
      <h4 class="text-center font-bold">Medlemskab</h4>
      <li class="text-center py-2 border-b">
        <a href="/tilmeld" aria-label="Gå til 'Tilmeld'" class="hover:text-blue-700 hover:underline transition duration-300 ease-in-out"
          >Bliv medlem</a
        >
      </li>
      <li class="text-center py-2">
        <a href="/stoet" aria-label="Gå til 'Støt os'" class="hover:text-blue-700 hover:underline transition duration-300 ease-in-out">Støt os</a>
      </li>
    </ul>
    <ul class="mx-auto py-4 text-gray-950">
      <h4 class="text-center font-bold">Bliv klogere</h4>
      <li class="text-center py-2 border-b">
        <a href="/raadgivning" aria-label="Gå til 'Rådgivning'" class="hover:text-blue-700 hover:underline transition duration-300 ease-in-out"
          >Rådgivning</a
        >
      </li>
      <li class="text-center py-2 border-b">
        <a href="/materialer" aria-label="Gå til 'Materialer'" class="hover:text-blue-700 hover:underline transition duration-300 ease-in-out"
          >Materialer</a
        >
      </li>
      <li class="text-center py-2 border-b">
        <a
          href="/kurser_aktiviteter"
          aria-label="Gå til 'Kurser & aktiviteter'"
          class="hover:text-blue-700 hover:underline transition duration-300 ease-in-out">Kurser & aktiviteter</a
        >
      </li>
    </ul>
    <ul class="mx-auto py-4 text-gray-950">
      <h4 class="text-center font-bold">Andet</h4>
      <li class="text-center py-2">
        <a href="/gode_raad" aria-label="Gå til 'Gode råd'" class="hover:text-blue-700 hover:underline transition duration-300 ease-in-out"
          >Gode råd</a
        >
      </li>
    </ul>
  </nav>
</div>

<style>
  [x-cloak] {
    display: none !important;
  }

  /* Dark Mode */
  body.dark #header {
    background-color: #333333;
  }
  body.dark #accessibility-bar {
    background-color: #222222;
    color: #f6f6f6;
  }
  body.dark #header .dropdown1,
  body.dark #header .dropdown2 {
    background-color: #454545;
    color: #f6f6f6;
    border-color: #6d6d6d;
  }

  /* Button styles for dark mode */
  body.dark .toggle-switch {
    background-color: #666;
  }
  body.dark .toggle-circle {
    background-color: #fff;
  }

  body.dark #header a:hover {
    color: #7dc1fc;
    animation-duration: 0.6s;
    text-decoration: underline;
    animation: ease-in-out;
  }

  body.dark #mobilmenu a,
  body.dark #mobilmenu h4 {
    color: #f6f6f6;
  }

  body.dark #mobilmenu a:hover {
    color: #7dc1fc;
  }

  /* Text Size Mode */
  body.text-large {
    font-size: 1.12rem;
    font-family: "Open Sans", sans-serif;
  }

  /* Reduce Motion Mode */
  body.reduce-motion * {
    transition: none !important;
    animation: none !important;
    scroll-behavior: auto !important;
  }

  body {
    transition:
      font-size 0.3s ease,
      background-color 0.3s ease,
      color 0.3s ease;
  }

  /* Logo */
  /* Light mode logo */
  .logo-dark {
    display: none;
  }

  /* Dark mode logo */
  body.dark .logo-light {
    display: none;
  }

  body.dark .logo-dark {
    display: block;
  }
</style>

<script>
  // Utility function to initialize toggle
  function initToggle(toggleId, className, storageKey) {
    const toggleButton = document.getElementById(toggleId);
    const savedState = localStorage.getItem(storageKey) === "true";

    // Apply saved state
    if (savedState) {
      document.body.classList.add(className);
      toggleButton.setAttribute("aria-pressed", "true");
    } else {
      toggleButton.setAttribute("aria-pressed", "false");
    }

    // Set up click handler
    toggleButton.addEventListener("click", () => {
      const isPressed = toggleButton.getAttribute("aria-pressed") === "true";
      const newState = !isPressed;

      toggleButton.setAttribute("aria-pressed", String(newState));
      document.body.classList.toggle(className, newState);
      localStorage.setItem(storageKey, String(newState));
    });
  }

  // Initialize each toggle
  initToggle("textSizeToggle", "text-large", "textSizeEnabled");
  initToggle("motionToggle", "reduce-motion", "motionReductionEnabled");
  initToggle("darkModeToggle", "dark", "darkModeEnabled");
</script>
